#include <catch2/catch_test_macros.hpp>

#include "Cryptography.hpp"

TEST_CASE("Hash key successful")
{
    Cryptography crypto;
    KeyData keyData = {0x12, 0x11, 0xAD, 0xB1, 0xFD, 0x44, 0x66, 0x00, 0x19};

    // https://cyberchef.io/#recipe=From_Hex('Auto')SHA2('256',64,160)&input=MHgxMiwgMHgxMSwgMHhBRCwgMHhCMSwgMHhGRCwgMHg0NCwgMHg2NiwgMHgwMCwgMHgxOQ
    Hash256 expectedHash = {0x30, 0x66, 0xe8, 0x4c, 0x41, 0xb4, 0x0e, 0x46, 
                            0xa5, 0x27, 0x32, 0xec, 0x3e, 0xc8, 0xaf, 0x38, 
                            0x9a, 0xb4, 0x8c, 0xbe, 0xba, 0xac, 0x0b, 0xe2, 
                            0x63, 0x63, 0x8c, 0x7a, 0x23, 0xc4, 0x0e, 0xb9};

    auto sha256Hash = crypto.hashKeySha256(keyData);

    REQUIRE(sha256Hash == expectedHash);
}